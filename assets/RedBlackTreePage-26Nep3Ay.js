import{j as l,m as te,P as J,S as xe,B as ge,d as Q,e as me,g as be,h as we,i as ve,k as je,l as ke,n as Se,R as Ne}from"./vendor-ui-C1ZhIyyN.js";import{r as o}from"./vendor-react-B3rwDall.js";import{v as Re}from"./v4-EwEgHOG0.js";import{S as $,C as Z,P as $e}from"./PlaybackControls-BPNwum8p.js";import{u as ye}from"./index-BLg--Z60.js";class W{id;value;color;left;right;parent;x=0;y=0;constructor(s,e="red"){this.id=Re(),this.value=s,this.color=e,this.left=null,this.right=null,this.parent=null}clone(){const s=new W(this.value,this.color);return s.id=this.id,this.left&&(s.left=this.left.clone(),s.left.parent=s),this.right&&(s.right=this.right.clone(),s.right.parent=s),s}}class Ce{root;steps;constructor(){this.root=null,this.steps=[]}getSnapshot(){return this.root?this.root.clone():null}addStep(s,e,i=[]){this.steps.push({type:s,message:e,targetIds:i,payload:{snapshot:this.getSnapshot()}})}leftRotate(s){const e=s.right;s.right=e.left,e.left&&(e.left.parent=s),e.parent=s.parent,s.parent?s===s.parent.left?s.parent.left=e:s.parent.right=e:this.root=e,e.left=s,s.parent=e,this.addStep("move",`Left rotation: node ${s.value} rotated with node ${e.value}`,[e.id,s.id])}rightRotate(s){const e=s.left;s.left=e.right,e.right&&(e.right.parent=s),e.parent=s.parent,s.parent?s===s.parent.left?s.parent.left=e:s.parent.right=e:this.root=e,e.right=s,s.parent=e,this.addStep("move",`Right rotation: node ${s.value} rotated with node ${e.value}`,[e.id,s.id])}insert(s){this.steps=[];const e=new W(s,"red");if(!this.root)return e.color="black",this.root=e,this.addStep("insert",`Inserted root ${s} (Black)`,[e.id]),this.steps;let i=this.root,t=null;for(;i;)if(t=i,s<i.value)i=i.left;else if(s>i.value)i=i.right;else return this.addStep("error",`Value ${s} already exists`,[i.id]),this.steps;return e.parent=t,s<t.value?t.left=e:t.right=e,this.addStep("insert",`Inserted ${s} (Red)`,[e.id]),this.insertFixup(e),this.addStep("complete",`Insertion of ${s} complete`),this.steps}insertFixup(s){let e=s;for(;e.parent&&e.parent.color==="red";){const i=e.parent.parent;if(e.parent===i.left){const t=i.right;t&&t.color==="red"?(this.addStep("highlight",`Case 3: Uncle ${t.value} is Red - Recoloring nodes ${e.parent.value}, ${t.value}, ${i.value}`,[e.parent.id,t.id,i.id]),e.parent.color="black",t.color="black",i.color="red",this.addStep("move",`Recolored: Parent ${e.parent.value}→Black, Uncle ${t.value}→Black, Grandparent ${i.value}→Red`,[e.parent.id,t.id,i.id]),e=i):(e===e.parent.right&&(e=e.parent,this.addStep("highlight",`Case 4: Triangle (LR) - Left rotate node ${e.value}`,[e.id]),this.leftRotate(e)),this.addStep("highlight",`Case 5: Line (LL) - Operating on nodes ${e.parent.value} and ${i.value}`,[e.parent.id,i.id]),e.parent.color="black",i.color="red",this.addStep("move",`Recolored: Node ${e.parent.value}→Black, Node ${i.value}→Red`,[e.parent.id,i.id]),this.rightRotate(i))}else{const t=i.left;t&&t.color==="red"?(this.addStep("highlight",`Case 3 (Mirror): Uncle ${t.value} is Red - Recoloring nodes ${e.parent.value}, ${t.value}, ${i.value}`,[e.parent.id,t.id,i.id]),e.parent.color="black",t.color="black",i.color="red",this.addStep("move",`Recolored: Parent ${e.parent.value}→Black, Uncle ${t.value}→Black, Grandparent ${i.value}→Red`,[e.parent.id,t.id,i.id]),e=i):(e===e.parent.left&&(e=e.parent,this.addStep("highlight",`Case 4 (Mirror): Triangle (RL) - Right rotate node ${e.value}`,[e.id]),this.rightRotate(e)),this.addStep("highlight",`Case 5 (Mirror): Line (RR) - Operating on nodes ${e.parent.value} and ${i.value}`,[e.parent.id,i.id]),e.parent.color="black",i.color="red",this.addStep("move",`Recolored: Node ${e.parent.value}→Black, Node ${i.value}→Red`,[e.parent.id,i.id]),this.leftRotate(i))}}this.root.color==="red"&&(this.root.color="black",this.addStep("move",`Root node ${this.root.value} recolored to black`,[this.root.id]))}delete(s){this.steps=[];let e=this.root;for(;e;)if(s<e.value)e=e.left;else if(s>e.value)e=e.right;else break;if(!e)return this.addStep("error",`Value ${s} not found`),this.steps;this.addStep("highlight",`Found node ${s} to delete`,[e.id]);let i=e,t=i.color,d,h;return e.left?e.right?(i=this.minimum(e.right),t=i.color,d=i.right,i.parent===e?h=i:(h=i.parent,this.transplant(i,i.right),i.right=e.right,i.right&&(i.right.parent=i)),this.transplant(e,i),i.left=e.left,i.left&&(i.left.parent=i),i.color=e.color):(d=e.left,h=e.parent,this.transplant(e,e.left)):(d=e.right,h=e.parent,this.transplant(e,e.right)),t==="black"&&this.deleteFixup(d,d?d.parent:h),this.addStep("complete",`Deletion of ${s} complete`),this.steps}transplant(s,e){s.parent?s===s.parent.left?s.parent.left=e:s.parent.right=e:this.root=e,e&&(e.parent=s.parent)}minimum(s){for(;s.left;)s=s.left;return s}deleteFixup(s,e){for(;(!s||s.color==="black")&&s!==this.root;)if(e?.left===s){let t=e.right;t&&t.color==="red"&&(this.addStep("highlight",`Fixup Case 1: Sibling ${t.value} is Red, operating on nodes ${t.value} and ${e.value}`,[t.id,e.id]),t.color="black",e.color="red",this.leftRotate(e),t=e.right),(!t?.left||t.left.color==="black")&&(!t?.right||t.right.color==="black")?(this.addStep("highlight",`Fixup Case 2: Sibling ${t?t.value:"null"} is Black with Black nephews`,[t?t.id:e.id]),t&&(t.color="red"),s=e,e=s?.parent||null):((!t?.right||t.right.color==="black")&&(this.addStep("highlight",`Fixup Case 3: Close nephew is Red - Rotate sibling ${t.value}`,[t.id]),t?.left&&(t.left.color="black"),t&&(t.color="red"),this.rightRotate(t),t=e.right),this.addStep("highlight",`Fixup Case 4: Far nephew is Red - Rotate parent ${e.value}`,[e.id]),t&&(t.color=e.color,t.right&&(t.right.color="black")),e.color="black",this.leftRotate(e),s=this.root,e=null)}else{let t=e.left;t&&t.color==="red"&&(this.addStep("highlight",`Fixup Case 1 (Mirror): Sibling ${t.value} is Red, operating on nodes ${t.value} and ${e.value}`,[t.id,e.id]),t.color="black",e.color="red",this.rightRotate(e),t=e.left),(!t?.right||t.right.color==="black")&&(!t?.left||t.left.color==="black")?(this.addStep("highlight",`Fixup Case 2 (Mirror): Sibling ${t?t.value:"null"} is Black with Black nephews`,[t?t.id:e.id]),t&&(t.color="red"),s=e,e=s?.parent||null):((!t?.left||t.left.color==="black")&&(this.addStep("highlight",`Fixup Case 3 (Mirror): Close nephew is Red - Rotate sibling ${t.value}`,[t.id]),t?.right&&(t.right.color="black"),t&&(t.color="red"),this.leftRotate(t),t=e.left),this.addStep("highlight",`Fixup Case 4 (Mirror): Far nephew is Red - Rotate parent ${e.value}`,[e.id]),t&&(t.color=e.color,t.left&&(t.left.color="black")),e.color="black",this.rightRotate(e),s=this.root,e=null)}s&&(s.color="black")}}const f=25,E=({node:a,x:s,y:e,level:i,highlightedIds:t=[]})=>{const d=t.includes(a.id),h=a.color==="red";return l.jsxs(l.Fragment,{children:[l.jsx(te.div,{initial:{left:s-f,top:e-f},animate:{left:s-f,top:e-f},transition:{duration:.3,ease:"easeOut"},className:`absolute flex items-center justify-center border-2 rounded-full shadow-md z-20 font-bold select-none text-white
          ${d?"ring-4 ring-amber-400 border-amber-500":h?"border-red-600":"border-slate-800"}
          ${h?"bg-red-500":"bg-slate-900"}
        `,style:{width:f*2,height:f*2},children:a.value},a.id),a.left&&l.jsxs(l.Fragment,{children:[l.jsx(ee,{parentX:s,parentY:e,childX:a.left.x,childY:a.left.y,childColor:a.left.color}),l.jsx(E,{node:a.left,x:a.left.x,y:a.left.y,level:i+1,highlightedIds:t})]}),a.right&&l.jsxs(l.Fragment,{children:[l.jsx(ee,{parentX:s,parentY:e,childX:a.right.x,childY:a.right.y,childColor:a.right.color}),l.jsx(E,{node:a.right,x:a.right.x,y:a.right.y,level:i+1,highlightedIds:t})]})]})},ee=({parentX:a,parentY:s,childX:e,childY:i,childColor:t})=>{const d=t==="red"?"#ef4444":"#cbd5e1";return l.jsx("svg",{className:"absolute top-0 left-0 w-px h-px overflow-visible pointer-events-none z-10",children:l.jsx(te.line,{initial:{x1:a,y1:s+f,x2:e,y2:i-f},animate:{x1:a,y1:s+f,x2:e,y2:i-f},transition:{duration:.3,ease:"easeOut"},stroke:d,strokeWidth:"2"})})},Me=()=>{const{t:a}=ye(["common","rbtree"],{useSuspense:!1}),[s]=o.useState(()=>new Ce),[e,i]=o.useState(null),[t,d]=o.useState([]),[h,N]=o.useState(-1),[x,y]=o.useState([]),[u,v]=o.useState(-1),[g,C]=o.useState(!1),[D,se]=o.useState(1),[le,O]=o.useState([]),[U,V]=o.useState(null),[b,z]=o.useState(!1),[T,I]=o.useState(""),F=o.useRef(null),[w,X]=o.useState(window.innerWidth>768),[m,L]=o.useState("logs"),[ie,re]=o.useState("menu"),[ae,oe]=o.useState(320),[R,H]=o.useState(!1),ne=()=>H(!0),G=()=>H(!1),_=r=>{if(R){const n=r.clientX;n>=280&&n<600&&oe(n)}};o.useEffect(()=>(window.addEventListener("mousemove",_),window.addEventListener("mouseup",G),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",G)}),[R]),o.useEffect(()=>{h===-1&&(d([{id:"init",action:"Initial",steps:[]}]),N(0))},[]),o.useEffect(()=>{if(b){const r=setTimeout(()=>z(!1),3e3);return()=>clearTimeout(r)}},[b]);const ce=r=>{if(!r)return null;const n=new Map,p=c=>{if(!c)return 0;const S=p(c.left),fe=p(c.right),q=Math.max(60,S+fe+40);return n.set(c.id,q),q};p(r);let k=0;const B=(c,S)=>{c&&(B(c.left,S+1),c.x=k*60,c.y=S*80,k++,B(c.right,S+1))};B(r,0);const ue=r.x,P=c=>{c&&(c.x-=ue,P(c.left),P(c.right))};return P(r),r},A=(r,n)=>{j(),y(n),v(0),d([...t.slice(0,h+1),{id:Math.random().toString(36),action:r,steps:n}]),N(p=>p+1),K(n.length)},K=(r,n=0)=>{C(!0);let p=n;const k=()=>{p<r-1?(p++,v(p),F.current=setTimeout(k,800/D)):C(!1)};k()},j=()=>{F.current&&clearTimeout(F.current),C(!1)},M=r=>{j(),r>=0&&r<x.length&&v(r)};o.useEffect(()=>{if(x.length>0&&u>=0){const r=x[u];r.payload?.snapshot!==void 0&&i(ce(r.payload.snapshot)),O(r.targetIds||[]),V(r.message||null)}},[u,x]);const Y=()=>{const r=parseInt(T);isNaN(r)||(A(`Insert ${r}`,s.insert(r)),I(""))},de=()=>{const r=parseInt(T);isNaN(r)||(A(`Delete ${r}`,s.delete(r)),I(""))},he=()=>{if(!b){z(!0);return}z(!1),g&&j(),s.root=null,i(null),d([{id:"init",action:"Cleared",steps:[]}]),N(0),y([]),v(-1),O([]),V(null)},pe=()=>m!=="tutorial"?null:ie==="menu"?l.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[l.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl border border-slate-700",children:[l.jsx("h3",{className:"text-white font-bold mb-1",children:"Red-Black Tree Course"}),l.jsx("p",{className:"text-xs text-slate-400",children:"Master the color-flipping balancing logic."})]}),l.jsxs("div",{className:"text-center py-10 opacity-30",children:[l.jsx(Q,{size:48,className:"mx-auto mb-4 text-slate-500"}),l.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-500",children:"Coming Soon"})]})]}):null;return l.jsxs("div",{className:`h-full w-full flex bg-slate-100 overflow-hidden relative font-sans text-slate-900 ${R?"cursor-col-resize select-none":""}`,children:[l.jsx("style",{children:R?"* { transition: none !important; cursor: col-resize !important; user-select: none !important; }":""}),l.jsxs("div",{style:{width:w?window.innerWidth>768?`${ae}px`:"100%":"0px"},className:`h-full flex flex-col bg-slate-900 border-r border-slate-800 shrink-0 z-[100] shadow-2xl relative ${w?"":"overflow-hidden"} ${window.innerWidth<=768?"fixed left-0 top-0":"relative"}`,children:[window.innerWidth<=768&&w&&l.jsx("button",{onClick:()=>X(!1),className:"absolute top-4 right-4 text-white z-[110]",children:l.jsx(J,{size:24})}),l.jsxs("div",{className:"flex flex-col h-full w-full",children:[l.jsxs("div",{className:"flex p-2 gap-1 bg-slate-950/50",children:[l.jsxs("button",{onClick:()=>L("logs"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="logs"?"bg-blue-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[l.jsx(xe,{size:14}),l.jsx("span",{className:"hidden sm:inline",children:"Logs"})]}),l.jsxs("button",{onClick:()=>L("wiki"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="wiki"?"bg-amber-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[l.jsx(ge,{size:14}),l.jsx("span",{className:"hidden sm:inline",children:"Wiki"})]}),l.jsxs("button",{onClick:()=>{L("tutorial"),re("menu")},className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="tutorial"?"bg-green-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[l.jsx(Q,{size:14}),l.jsx("span",{className:"hidden sm:inline",children:"Course"})]})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-4 font-mono text-[10px] text-slate-300 custom-scrollbar",children:[m==="logs"&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("h3",{className:"text-slate-500 font-black uppercase tracking-[0.2em] mb-4",children:"History"}),t.slice(1).reverse().map((r,n)=>l.jsxs("button",{onClick:()=>{j(),y(r.steps),v(r.steps.length-1),N(t.length-1-n)},className:`w-full text-left p-3 rounded-xl border transition-all ${h===t.length-1-n?"bg-blue-600/20 border-blue-500/50 text-blue-100 shadow-inner":"bg-slate-800/30 border-slate-700/50 hover:bg-slate-800 text-slate-400"}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l.jsx("span",{className:"font-black uppercase tracking-wider",children:r.action}),l.jsxs("span",{className:"opacity-40 text-[8px]",children:[r.steps.length," steps"]})]}),l.jsx("div",{className:"text-[9px] opacity-60 truncate",children:r.steps[r.steps.length-1]?.message})]},r.id))]}),m==="wiki"&&l.jsxs("div",{className:"space-y-8 font-sans pb-12 text-slate-400",children:[l.jsx("h3",{className:"text-white font-black text-xs uppercase tracking-[0.3em]",children:"Knowledge Base"}),l.jsxs("section",{children:[l.jsx("h4",{className:"text-blue-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.concept")}),l.jsx($,{text:a("rbtree:wiki.conceptDesc")})]}),l.jsxs("section",{children:[l.jsx("h4",{className:"text-green-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.properties")}),l.jsx($,{text:a("rbtree:wiki.propertiesDesc")})]}),l.jsxs("section",{children:[l.jsx("h4",{className:"text-amber-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.insertion")}),l.jsx($,{text:a("rbtree:wiki.insertionDesc")})]}),l.jsxs("section",{children:[l.jsx("h4",{className:"text-purple-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.complexity")}),l.jsx($,{text:a("rbtree:wiki.complexityDesc")})]})]}),m==="tutorial"&&pe()]})]}),w&&window.innerWidth>768&&l.jsx("div",{onMouseDown:ne,className:"absolute right-0 top-0 w-1.5 h-full cursor-col-resize z-[120] hover:bg-blue-500/50"})]}),l.jsxs("div",{className:"flex-grow flex flex-col min-w-0 h-full relative bg-white",children:[l.jsxs("div",{className:"flex-grow relative overflow-hidden bg-grid-slate-100",children:[l.jsx("button",{onClick:()=>X(!w),className:"absolute bottom-6 left-6 z-30 w-10 h-10 bg-slate-900 text-white rounded-2xl shadow-xl flex items-center justify-center hover:scale-110 active:scale-90 transition-all",children:w?l.jsx(J,{size:20}):l.jsx(me,{size:20})}),l.jsx("div",{className:"absolute top-6 left-6 z-20 pointer-events-none",children:U&&l.jsxs("div",{className:"bg-blue-600/90 backdrop-blur-md px-4 py-2 rounded-2xl text-white shadow-lg border border-blue-400 flex items-center gap-2 animate-in slide-in-from-left-4",children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse shrink-0"}),l.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:U})]})}),l.jsx(be,{initialScale:1,minScale:.1,maxScale:2,centerOnInit:!0,children:({zoomIn:r,zoomOut:n,resetTransform:p})=>l.jsxs(l.Fragment,{children:[l.jsx(we,{wrapperStyle:{width:"100%",height:"100%"},children:l.jsx("div",{className:"w-[4000px] h-[4000px] relative cursor-grab active:cursor-grabbing",children:l.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{overflow:"visible"},children:e&&l.jsx(E,{node:e,x:e.x,y:e.y,level:0,highlightedIds:le})})})}),l.jsxs("div",{className:"absolute bottom-6 right-6 z-20 flex flex-col gap-2",children:[l.jsx("button",{onClick:()=>r(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:l.jsx(ve,{size:20})}),l.jsx("button",{onClick:()=>n(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:l.jsx(je,{size:20})}),l.jsx("button",{onClick:()=>p(),className:"w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center shadow-lg active:scale-90 mt-2",children:l.jsx(ke,{size:20})})]})]})})]}),l.jsxs("div",{className:"bg-white border-t border-slate-200 p-3 sm:p-4 flex flex-col lg:flex-row gap-4 lg:gap-4 items-stretch overflow-visible shadow-[0_-10px_40px_rgba(0,0,0,0.03)] z-[100]",children:[l.jsxs(Z,{label:"Operations",className:"w-full lg:w-[320px]",children:[l.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 w-full",children:[l.jsxs("div",{className:"flex gap-2 items-center bg-white p-1 rounded-xl border border-slate-200 flex-grow overflow-hidden shadow-sm",children:[l.jsx("input",{value:T,onChange:r=>I(r.target.value),onKeyDown:r=>r.key==="Enter"&&Y(),className:"flex-grow min-w-0 px-2 text-xs font-bold outline-none text-center",placeholder:"Val"}),l.jsx("button",{onClick:Y,disabled:g,className:"px-4 py-1.5 bg-blue-600 text-white rounded-lg text-[11px] font-black shadow-md shrink-0 active:scale-95 transition-all",children:"INSERT"})]}),l.jsxs("button",{onClick:de,disabled:g,className:"px-4 py-2.5 bg-red-600 text-white rounded-xl text-[11px] font-black shadow-lg flex items-center gap-2 active:scale-95 transition-all shrink-0",children:[l.jsx(Se,{size:14})," DELETE"]})]}),l.jsxs("button",{onClick:he,disabled:g,className:`w-full flex items-center justify-center gap-2 py-1.5 border border-dashed text-[10px] font-black rounded-lg transition-all uppercase tracking-widest ${b?"bg-red-600 border-red-600 text-white animate-bounce":"border-slate-200 text-slate-400 hover:bg-red-50 hover:text-red-500"}`,children:[l.jsx(Ne,{size:12,className:b?"animate-spin":""})," ",b?"Confirm Reset?":"Reset Playground"]})]}),l.jsx(Z,{label:"Timeline",className:"flex-grow",metadata:`Step ${Math.max(0,u+1)} / ${x.length}`,children:l.jsx($e,{isPlaying:g,isPaused:!g,onTogglePause:()=>g?j():K(x.length,u),onGoToStep:M,currentStep:u,totalSteps:x.length,onUndo:()=>M(Math.max(0,u-1)),onRedo:()=>M(Math.min(x.length-1,u+1)),canUndo:u>0,canRedo:u<x.length-1,playbackSpeed:D,setPlaybackSpeed:se})})]})]})]})};export{Me as RedBlackTreePage};
