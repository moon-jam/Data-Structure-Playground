import{j as s,m as le,P as Z,S as me,B as be,d as ee,e as we,g as ve,h as je,i as ke,k as Se,l as Ne,n as Re,R as $e}from"./vendor-ui-C1ZhIyyN.js";import{r as o}from"./vendor-react-B3rwDall.js";import{v as ye}from"./v4-EwEgHOG0.js";import{S as $,C as te,P as Ce}from"./PlaybackControls-BPNwum8p.js";import{u as ze}from"./index-DarUN0a9.js";class O{id;value;color;left;right;parent;x=0;y=0;constructor(l,e="red"){this.id=ye(),this.value=l,this.color=e,this.left=null,this.right=null,this.parent=null}clone(){const l=new O(this.value,this.color);return l.id=this.id,this.left&&(l.left=this.left.clone(),l.left.parent=l),this.right&&(l.right=this.right.clone(),l.right.parent=l),l}}class Te{root;steps;constructor(){this.root=null,this.steps=[]}getSnapshot(){return this.root?this.root.clone():null}addStep(l,e,i=[]){this.steps.push({type:l,message:e,targetIds:i,payload:{snapshot:this.getSnapshot()}})}leftRotate(l){const e=l.right;l.right=e.left,e.left&&(e.left.parent=l),e.parent=l.parent,l.parent?l===l.parent.left?l.parent.left=e:l.parent.right=e:this.root=e,e.left=l,l.parent=e,this.addStep("move",`Left rotation: node ${l.value} rotated with node ${e.value}`,[e.id,l.id])}rightRotate(l){const e=l.left;l.left=e.right,e.right&&(e.right.parent=l),e.parent=l.parent,l.parent?l===l.parent.left?l.parent.left=e:l.parent.right=e:this.root=e,e.right=l,l.parent=e,this.addStep("move",`Right rotation: node ${l.value} rotated with node ${e.value}`,[e.id,l.id])}insert(l){this.steps=[];const e=new O(l,"red");if(!this.root)return e.color="black",this.root=e,this.addStep("insert",`Inserted root ${l} (Black)`,[e.id]),this.steps;let i=this.root,t=null;for(;i;)if(t=i,l<i.value)i=i.left;else if(l>i.value)i=i.right;else return this.addStep("error",`Value ${l} already exists`,[i.id]),this.steps;return e.parent=t,l<t.value?t.left=e:t.right=e,this.addStep("insert",`Inserted ${l} (Red)`,[e.id]),this.insertFixup(e),this.addStep("complete",`Insertion of ${l} complete`),this.steps}insertFixup(l){let e=l;for(;e.parent&&e.parent.color==="red";){const i=e.parent.parent;if(e.parent===i.left){const t=i.right;t&&t.color==="red"?(this.addStep("highlight",`Case 3: Uncle ${t.value} is Red - Recoloring nodes ${e.parent.value}, ${t.value}, ${i.value}`,[e.parent.id,t.id,i.id]),e.parent.color="black",t.color="black",i.color="red",this.addStep("move",`Recolored: Parent ${e.parent.value}→Black, Uncle ${t.value}→Black, Grandparent ${i.value}→Red`,[e.parent.id,t.id,i.id]),e=i):(e===e.parent.right&&(e=e.parent,this.addStep("highlight",`Case 4: Triangle (LR) - Left rotate node ${e.value}`,[e.id]),this.leftRotate(e)),this.addStep("highlight",`Case 5: Line (LL) - Operating on nodes ${e.parent.value} and ${i.value}`,[e.parent.id,i.id]),e.parent.color="black",i.color="red",this.addStep("move",`Recolored: Node ${e.parent.value}→Black, Node ${i.value}→Red`,[e.parent.id,i.id]),this.rightRotate(i))}else{const t=i.left;t&&t.color==="red"?(this.addStep("highlight",`Case 3 (Mirror): Uncle ${t.value} is Red - Recoloring nodes ${e.parent.value}, ${t.value}, ${i.value}`,[e.parent.id,t.id,i.id]),e.parent.color="black",t.color="black",i.color="red",this.addStep("move",`Recolored: Parent ${e.parent.value}→Black, Uncle ${t.value}→Black, Grandparent ${i.value}→Red`,[e.parent.id,t.id,i.id]),e=i):(e===e.parent.left&&(e=e.parent,this.addStep("highlight",`Case 4 (Mirror): Triangle (RL) - Right rotate node ${e.value}`,[e.id]),this.rightRotate(e)),this.addStep("highlight",`Case 5 (Mirror): Line (RR) - Operating on nodes ${e.parent.value} and ${i.value}`,[e.parent.id,i.id]),e.parent.color="black",i.color="red",this.addStep("move",`Recolored: Node ${e.parent.value}→Black, Node ${i.value}→Red`,[e.parent.id,i.id]),this.leftRotate(i))}}this.root.color==="red"&&(this.root.color="black",this.addStep("move",`Root node ${this.root.value} recolored to black`,[this.root.id]))}delete(l){this.steps=[];let e=this.root;for(;e;)if(l<e.value)e=e.left;else if(l>e.value)e=e.right;else break;if(!e)return this.addStep("error",`Value ${l} not found`),this.steps;this.addStep("highlight",`Found node ${l} to delete`,[e.id]);let i=e,t=i.color,n,h;return e.left?e.right?(i=this.minimum(e.right),t=i.color,n=i.right,i.parent===e?h=i:(h=i.parent,this.transplant(i,i.right),i.right=e.right,i.right&&(i.right.parent=i)),this.transplant(e,i),i.left=e.left,i.left&&(i.left.parent=i),i.color=e.color):(n=e.left,h=e.parent,this.transplant(e,e.left)):(n=e.right,h=e.parent,this.transplant(e,e.right)),t==="black"&&this.deleteFixup(n,n?n.parent:h),this.addStep("complete",`Deletion of ${l} complete`),this.steps}transplant(l,e){l.parent?l===l.parent.left?l.parent.left=e:l.parent.right=e:this.root=e,e&&(e.parent=l.parent)}minimum(l){for(;l.left;)l=l.left;return l}deleteFixup(l,e){for(;(!l||l.color==="black")&&l!==this.root;)if(e?.left===l){let t=e.right;t&&t.color==="red"&&(this.addStep("highlight",`Fixup Case 1: Sibling ${t.value} is Red, operating on nodes ${t.value} and ${e.value}`,[t.id,e.id]),t.color="black",e.color="red",this.leftRotate(e),t=e.right),(!t?.left||t.left.color==="black")&&(!t?.right||t.right.color==="black")?(this.addStep("highlight",`Fixup Case 2: Sibling ${t?t.value:"null"} is Black with Black nephews`,[t?t.id:e.id]),t&&(t.color="red"),l=e,e=l?.parent||null):((!t?.right||t.right.color==="black")&&(this.addStep("highlight",`Fixup Case 3: Close nephew is Red - Rotate sibling ${t.value}`,[t.id]),t?.left&&(t.left.color="black"),t&&(t.color="red"),this.rightRotate(t),t=e.right),this.addStep("highlight",`Fixup Case 4: Far nephew is Red - Rotate parent ${e.value}`,[e.id]),t&&(t.color=e.color,t.right&&(t.right.color="black")),e.color="black",this.leftRotate(e),l=this.root,e=null)}else{let t=e.left;t&&t.color==="red"&&(this.addStep("highlight",`Fixup Case 1 (Mirror): Sibling ${t.value} is Red, operating on nodes ${t.value} and ${e.value}`,[t.id,e.id]),t.color="black",e.color="red",this.rightRotate(e),t=e.left),(!t?.right||t.right.color==="black")&&(!t?.left||t.left.color==="black")?(this.addStep("highlight",`Fixup Case 2 (Mirror): Sibling ${t?t.value:"null"} is Black with Black nephews`,[t?t.id:e.id]),t&&(t.color="red"),l=e,e=l?.parent||null):((!t?.left||t.left.color==="black")&&(this.addStep("highlight",`Fixup Case 3 (Mirror): Close nephew is Red - Rotate sibling ${t.value}`,[t.id]),t?.right&&(t.right.color="black"),t&&(t.color="red"),this.leftRotate(t),t=e.left),this.addStep("highlight",`Fixup Case 4 (Mirror): Far nephew is Red - Rotate parent ${e.value}`,[e.id]),t&&(t.color=e.color,t.left&&(t.left.color="black")),e.color="black",this.rightRotate(e),l=this.root,e=null)}l&&(l.color="black")}}const x=25,D=({node:a,x:l,y:e,level:i,highlightedIds:t=[],selectedId:n,onNodeClick:h})=>{const b=t.includes(a.id),u=n===a.id,w=a.color==="red";return s.jsxs(s.Fragment,{children:[s.jsx(le.div,{initial:{left:l-x,top:e-x},animate:{left:l-x,top:e-x},transition:{duration:.3,ease:"easeOut"},onClick:p=>{p.stopPropagation(),h?.(a)},className:`absolute flex items-center justify-center border-2 rounded-full shadow-md z-20 font-bold select-none text-white cursor-pointer hover:scale-110 transition-transform
          ${u?"ring-4 ring-blue-400 border-blue-500":b?"ring-4 ring-amber-400 border-amber-500":w?"border-red-600":"border-slate-800"}
          ${w?"bg-red-500":"bg-slate-900"}
        `,style:{width:x*2,height:x*2},children:a.value},a.id),a.left&&s.jsxs(s.Fragment,{children:[s.jsx(se,{parentX:l,parentY:e,childX:a.left.x,childY:a.left.y,childColor:a.left.color}),s.jsx(D,{node:a.left,x:a.left.x,y:a.left.y,level:i+1,highlightedIds:t,selectedId:n,onNodeClick:h})]}),a.right&&s.jsxs(s.Fragment,{children:[s.jsx(se,{parentX:l,parentY:e,childX:a.right.x,childY:a.right.y,childColor:a.right.color}),s.jsx(D,{node:a.right,x:a.right.x,y:a.right.y,level:i+1,highlightedIds:t,selectedId:n,onNodeClick:h})]})]})},se=({parentX:a,parentY:l,childX:e,childY:i,childColor:t})=>{const n=t==="red"?"#ef4444":"#cbd5e1";return s.jsx("svg",{className:"absolute top-0 left-0 w-px h-px overflow-visible pointer-events-none z-10",children:s.jsx(le.line,{initial:{x1:a,y1:l+x,x2:e,y2:i-x},animate:{x1:a,y1:l+x,x2:e,y2:i-x},transition:{duration:.3,ease:"easeOut"},stroke:n,strokeWidth:"2"})})},Be=()=>{const{t:a}=ze(["common","rbtree"],{useSuspense:!1}),[l]=o.useState(()=>new Te),[e,i]=o.useState(null),[t,n]=o.useState([]),[h,b]=o.useState(-1),[u,w]=o.useState([]),[p,k]=o.useState(-1),[g,C]=o.useState(!1),[U,ie]=o.useState(1),[re,V]=o.useState([]),[X,H]=o.useState(null),[v,z]=o.useState(!1),[T,F]=o.useState(null),[I,L]=o.useState(""),M=o.useRef(null),[j,G]=o.useState(window.innerWidth>768),[m,P]=o.useState("logs"),[ae,oe]=o.useState("menu"),[ne,ce]=o.useState(320),[y,_]=o.useState(!1),de=()=>_(!0),A=()=>_(!1),K=r=>{if(y){const c=r.clientX;c>=280&&c<600&&ce(c)}};o.useEffect(()=>(window.addEventListener("mousemove",K),window.addEventListener("mouseup",A),()=>{window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",A)}),[y]),o.useEffect(()=>{h===-1&&(n([{id:"init",action:"Initial",steps:[]}]),b(0))},[]),o.useEffect(()=>{if(v){const r=setTimeout(()=>z(!1),3e3);return()=>clearTimeout(r)}},[v]);const he=r=>{if(!r)return null;const c=new Map,f=d=>{if(!d)return 0;const R=f(d.left),ge=f(d.right),Q=Math.max(60,R+ge+40);return c.set(d.id,Q),Q};f(r);let N=0;const E=(d,R)=>{d&&(E(d.left,R+1),d.x=N*60,d.y=R*80,N++,E(d.right,R+1))};E(r,0);const xe=r.x,W=d=>{d&&(d.x-=xe,W(d.left),W(d.right))};return W(r),r},Y=(r,c)=>{S(),w(c),k(0),n([...t.slice(0,h+1),{id:Math.random().toString(36),action:r,steps:c}]),b(f=>f+1),q(c.length)},q=(r,c=0)=>{C(!0);let f=c;const N=()=>{f<r-1?(f++,k(f),M.current=setTimeout(N,800/U)):C(!1)};N()},S=()=>{M.current&&clearTimeout(M.current),C(!1)},B=r=>{S(),r>=0&&r<u.length&&k(r)};o.useEffect(()=>{if(u.length>0&&p>=0){const r=u[p];r.payload?.snapshot!==void 0&&i(he(r.payload.snapshot)),V(r.targetIds||[]),H(r.message||null)}},[p,u]);const J=()=>{const r=parseInt(I);isNaN(r)||(Y(`Insert ${r}`,l.insert(r)),L(""))},pe=()=>{const r=T?T.value:parseInt(I);isNaN(r)||(Y(`Delete ${r}`,l.delete(r)),L(""),F(null))},ue=()=>{if(!v){z(!0);return}z(!1),g&&S(),l.root=null,i(null),n([{id:"init",action:"Cleared",steps:[]}]),b(0),w([]),k(-1),V([]),H(null),F(null)},fe=()=>m!=="tutorial"?null:ae==="menu"?s.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[s.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl border border-slate-700",children:[s.jsx("h3",{className:"text-white font-bold mb-1",children:"Red-Black Tree Course"}),s.jsx("p",{className:"text-xs text-slate-400",children:"Master the color-flipping balancing logic."})]}),s.jsxs("div",{className:"text-center py-10 opacity-30",children:[s.jsx(ee,{size:48,className:"mx-auto mb-4 text-slate-500"}),s.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-500",children:"Coming Soon"})]})]}):null;return s.jsxs("div",{className:`h-full w-full flex bg-slate-100 overflow-hidden relative font-sans text-slate-900 ${y?"cursor-col-resize select-none":""}`,children:[s.jsx("style",{children:y?"* { transition: none !important; cursor: col-resize !important; user-select: none !important; }":""}),s.jsxs("div",{style:{width:j?window.innerWidth>768?`${ne}px`:"100%":"0px"},className:`h-full flex flex-col bg-slate-900 border-r border-slate-800 shrink-0 z-[100] shadow-2xl relative ${j?"":"overflow-hidden"} ${window.innerWidth<=768?"fixed left-0 top-0":"relative"}`,children:[window.innerWidth<=768&&j&&s.jsx("button",{onClick:()=>G(!1),className:"absolute top-4 right-4 text-white z-[110]",children:s.jsx(Z,{size:24})}),s.jsxs("div",{className:"flex flex-col h-full w-full",children:[s.jsxs("div",{className:"flex p-2 gap-1 bg-slate-950/50",children:[s.jsxs("button",{onClick:()=>P("logs"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="logs"?"bg-blue-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[s.jsx(me,{size:14}),s.jsx("span",{className:"hidden sm:inline",children:"Logs"})]}),s.jsxs("button",{onClick:()=>P("wiki"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="wiki"?"bg-amber-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[s.jsx(be,{size:14}),s.jsx("span",{className:"hidden sm:inline",children:"Wiki"})]}),s.jsxs("button",{onClick:()=>{P("tutorial"),oe("menu")},className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${m==="tutorial"?"bg-green-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[s.jsx(ee,{size:14}),s.jsx("span",{className:"hidden sm:inline",children:"Course"})]})]}),s.jsxs("div",{className:"flex-grow overflow-y-auto p-4 font-mono text-[10px] text-slate-300 custom-scrollbar",children:[m==="logs"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-slate-500 font-black uppercase tracking-[0.2em] mb-4",children:"History"}),t.slice(1).reverse().map((r,c)=>s.jsxs("button",{onClick:()=>{S(),w(r.steps),k(r.steps.length-1),b(t.length-1-c)},className:`w-full text-left p-3 rounded-xl border transition-all ${h===t.length-1-c?"bg-blue-600/20 border-blue-500/50 text-blue-100 shadow-inner":"bg-slate-800/30 border-slate-700/50 hover:bg-slate-800 text-slate-400"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-1",children:[s.jsx("span",{className:"font-black uppercase tracking-wider",children:r.action}),s.jsxs("span",{className:"opacity-40 text-[8px]",children:[r.steps.length," steps"]})]}),s.jsx("div",{className:"text-[9px] opacity-60 truncate",children:r.steps[r.steps.length-1]?.message})]},r.id))]}),m==="wiki"&&s.jsxs("div",{className:"space-y-8 font-sans pb-12 text-slate-400",children:[s.jsx("h3",{className:"text-white font-black text-xs uppercase tracking-[0.3em]",children:"Knowledge Base"}),s.jsxs("section",{children:[s.jsx("h4",{className:"text-blue-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.concept")}),s.jsx($,{text:a("rbtree:wiki.conceptDesc")})]}),s.jsxs("section",{children:[s.jsx("h4",{className:"text-green-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.properties")}),s.jsx($,{text:a("rbtree:wiki.propertiesDesc")})]}),s.jsxs("section",{children:[s.jsx("h4",{className:"text-amber-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.insertion")}),s.jsx($,{text:a("rbtree:wiki.insertionDesc")})]}),s.jsxs("section",{children:[s.jsx("h4",{className:"text-rose-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.deletion")}),s.jsx($,{text:a("rbtree:wiki.deletionDesc")})]}),s.jsxs("section",{children:[s.jsx("h4",{className:"text-purple-400 font-bold text-sm mb-2 uppercase",children:a("rbtree:wiki.complexity")}),s.jsx($,{text:a("rbtree:wiki.complexityDesc")})]})]}),m==="tutorial"&&fe()]})]}),j&&window.innerWidth>768&&s.jsx("div",{onMouseDown:de,className:"absolute right-0 top-0 w-1.5 h-full cursor-col-resize z-[120] hover:bg-blue-500/50"})]}),s.jsxs("div",{className:"flex-grow flex flex-col min-w-0 h-full relative bg-white",children:[s.jsxs("div",{className:"flex-grow relative overflow-hidden bg-grid-slate-100",children:[s.jsx("button",{onClick:()=>G(!j),className:"absolute bottom-6 left-6 z-30 w-10 h-10 bg-slate-900 text-white rounded-2xl shadow-xl flex items-center justify-center hover:scale-110 active:scale-90 transition-all",children:j?s.jsx(Z,{size:20}):s.jsx(we,{size:20})}),s.jsx("div",{className:"absolute top-6 left-6 z-20 pointer-events-none",children:X&&s.jsxs("div",{className:"bg-blue-600/90 backdrop-blur-md px-4 py-2 rounded-2xl text-white shadow-lg border border-blue-400 flex items-center gap-2 animate-in slide-in-from-left-4",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse shrink-0"}),s.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:X})]})}),s.jsx(ve,{initialScale:1,minScale:.1,maxScale:2,centerOnInit:!0,children:({zoomIn:r,zoomOut:c,resetTransform:f})=>s.jsxs(s.Fragment,{children:[s.jsx(je,{wrapperStyle:{width:"100%",height:"100%"},children:s.jsx("div",{className:"w-[4000px] h-[4000px] relative cursor-grab active:cursor-grabbing",children:s.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{overflow:"visible"},children:e&&s.jsx(D,{node:e,x:e.x,y:e.y,level:0,highlightedIds:re,selectedId:T?.id,onNodeClick:F})})})}),s.jsxs("div",{className:"absolute bottom-6 right-6 z-20 flex flex-col gap-2",children:[s.jsx("button",{onClick:()=>r(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:s.jsx(ke,{size:20})}),s.jsx("button",{onClick:()=>c(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:s.jsx(Se,{size:20})}),s.jsx("button",{onClick:()=>f(),className:"w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center shadow-lg active:scale-90 mt-2",children:s.jsx(Ne,{size:20})})]})]})})]}),s.jsxs("div",{className:"bg-white border-t border-slate-200 p-3 sm:p-4 flex flex-col lg:flex-row gap-4 lg:gap-4 items-stretch overflow-visible shadow-[0_-10px_40px_rgba(0,0,0,0.03)] z-[100]",children:[s.jsxs(te,{label:"Operations",className:"w-full lg:w-[320px]",children:[s.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 w-full",children:[s.jsxs("div",{className:"flex gap-2 items-center bg-white p-1 rounded-xl border border-slate-200 flex-grow overflow-hidden shadow-sm",children:[s.jsx("input",{value:I,onChange:r=>L(r.target.value),onKeyDown:r=>r.key==="Enter"&&J(),className:"flex-grow min-w-0 px-2 text-xs font-bold outline-none text-center",placeholder:"Val"}),s.jsx("button",{onClick:J,disabled:g,className:"px-4 py-1.5 bg-blue-600 text-white rounded-lg text-[11px] font-black shadow-md shrink-0 active:scale-95 transition-all",children:"INSERT"})]}),s.jsxs("button",{onClick:pe,disabled:g,className:"px-4 py-2.5 bg-red-600 text-white rounded-xl text-[11px] font-black shadow-lg flex items-center gap-2 active:scale-95 transition-all shrink-0",children:[s.jsx(Re,{size:14})," DELETE"]})]}),s.jsxs("button",{onClick:ue,disabled:g,className:`w-full flex items-center justify-center gap-2 py-1.5 border border-dashed text-[10px] font-black rounded-lg transition-all uppercase tracking-widest ${v?"bg-red-600 border-red-600 text-white animate-bounce":"border-slate-200 text-slate-400 hover:bg-red-50 hover:text-red-500"}`,children:[s.jsx($e,{size:12,className:v?"animate-spin":""})," ",v?"Confirm Reset?":"Reset Playground"]})]}),s.jsx(te,{label:"Timeline",className:"flex-grow",metadata:`Step ${Math.max(0,p+1)} / ${u.length}`,children:s.jsx(Ce,{isPlaying:g,isPaused:!g,onTogglePause:()=>g?S():q(u.length,p),onGoToStep:B,currentStep:p,totalSteps:u.length,onUndo:()=>B(Math.max(0,p-1)),onRedo:()=>B(Math.min(u.length-1,p+1)),canUndo:p>0,canRedo:p<u.length-1,playbackSpeed:U,setPlaybackSpeed:ie})})]})]})]})};export{Be as RedBlackTreePage};
