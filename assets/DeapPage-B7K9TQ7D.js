import{j as e,m as J,P as K,S as pe,B as de,e as q,f as xe,h as ue,i as me,k as fe,l as ge,n as be,q as we,r as je,R as ve}from"./vendor-ui-Cz_4H6In.js";import{r as h}from"./vendor-react-B3rwDall.js";import{S as y,C as L,P as Se}from"./PlaybackControls-D-X7RUzq.js";import{u as Me}from"./index-DR3OijTl.js";class Ne{heap;steps;constructor(){this.heap=[null,null],this.steps=[]}getSnapshot(){return[...this.heap]}addStep(a,t,s=[]){const o=s.map(l=>`node-${l}`);this.steps.push({type:a,message:t,targetIds:o,payload:{snapshot:this.getSnapshot()}})}insert(a){this.steps=[];const t=this.heap.length;if(this.heap.push(a),this.addStep("insert",`Inserted ${a} at position ${t}`,[t]),t===2)return this.addStep("complete","First element placed in Min-Heap root"),this.steps;if(t===3)return this.heap[2]>this.heap[3]&&(this.addStep("highlight","Min-Heap root > Max-Heap root. Swapping.",[2,3]),this.swap(2,3)),this.addStep("complete","Placed in Max-Heap root"),this.steps;if(this.inMinHeap(t)){let s=this.partner(t);s>=this.heap.length&&(s=Math.floor(s/2)),this.heap[s]!==null&&a>this.heap[s]?(this.addStep("highlight",`${a} > partner ${this.heap[s]}, swap and push up Max`,[t,s]),this.swap(t,s),this.pushUpMax(s)):this.pushUpMin(t)}else{const s=this.partner(t);s<this.heap.length&&this.heap[s]!==null&&a<this.heap[s]?(this.addStep("highlight",`${a} < partner ${this.heap[s]}, swap and push up Min`,[t,s]),this.swap(t,s),this.pushUpMin(s)):this.pushUpMax(t)}return this.addStep("complete","Insertion complete"),this.steps}extractMin(){if(this.steps=[],this.heap.length<=2)return this.steps;const a=this.heap[2];this.addStep("highlight",`Extracting Min: ${a}`,[2]);const t=this.heap.pop();return this.heap.length>2&&(this.heap[2]=t,this.addStep("move",`Moved last element ${t} to Min Root`,[2]),this.pushDownMin(2)),this.addStep("complete",`Extracted Min: ${a}`),this.steps}extractMax(){if(this.steps=[],this.heap.length<=2)return this.steps;if(this.heap.length===3){const s=this.heap[2];return this.heap.pop(),this.addStep("complete",`Extracted Max: ${s} (Single element)`),this.steps}const a=this.heap[3];this.addStep("highlight",`Extracting Max: ${a}`,[3]);const t=this.heap.pop();return this.heap.length>3&&(this.heap[3]=t,this.addStep("move",`Moved last element ${t} to Max Root`,[3]),this.pushDownMax(3)),this.addStep("complete",`Extracted Max: ${a}`),this.steps}pushUpMin(a){let t=a;for(;t>2;){const s=Math.floor(t/2);if(this.heap[t]<this.heap[s])this.addStep("highlight",`Min: ${this.heap[t]} < parent ${this.heap[s]}, swap`,[t,s]),this.swap(t,s),t=s;else break}}pushUpMax(a){let t=a;for(;t>3;){const s=Math.floor(t/2);if(this.heap[t]>this.heap[s])this.addStep("highlight",`Max: ${this.heap[t]} > parent ${this.heap[s]}, swap`,[t,s]),this.swap(t,s),t=s;else break}}pushDownMin(a){let t=a;for(;;){const s=2*t,o=2*t+1;let l=t;if(s<this.heap.length&&this.heap[s]<this.heap[l]&&(l=s),o<this.heap.length&&this.heap[o]<this.heap[l]&&(l=o),l!==t)this.addStep("highlight",`Min: Swapping with smaller child ${this.heap[l]}`,[t,l]),this.swap(t,l),t=l;else{const r=this.partner(t);if(r<this.heap.length)this.heap[t]>this.heap[r]&&(this.addStep("highlight",`DEAP Violation: Min ${this.heap[t]} > Max Partner ${this.heap[r]}`,[t,r]),this.swap(t,r),this.pushUpMax(r));else if(r>3){const p=Math.floor(r/2);this.heap[t]>this.heap[p]&&(this.addStep("highlight",`DEAP Violation: Min ${this.heap[t]} > Max Partner's Parent ${this.heap[p]}`,[t,p]),this.swap(t,p),this.pushUpMax(p))}break}}}pushDownMax(a){let t=a;for(;;){const s=2*t,o=2*t+1;let l=t;if(s<this.heap.length&&this.heap[s]>this.heap[l]&&(l=s),o<this.heap.length&&this.heap[o]>this.heap[l]&&(l=o),l!==t)this.addStep("highlight",`Max: Swapping with larger child ${this.heap[l]}`,[t,l]),this.swap(t,l),t=l;else{const r=this.partner(t);this.heap[r]>this.heap[t]&&(this.addStep("highlight",`DEAP Violation: Max ${this.heap[t]} < Min Partner ${this.heap[r]}`,[t,r]),this.swap(t,r),this.pushUpMin(r));break}}}swap(a,t){const s=this.heap[a];this.heap[a]=this.heap[t],this.heap[t]=s}inMinHeap(a){return a<=1?!1:a===2?!0:a===3?!1:this.inMinHeap(Math.floor(a/2))}partner(a){const s=1<<Math.floor(Math.log2(a))-1;return a^s}}const g=40,k=60,ye=c=>{if(c<=1)return"root";const a=Math.floor(Math.log2(c));return(c>>a-1&1)===0?"min":"max"},Z=({value:c,index:a,highlightedIndices:t})=>{if(c===null&&a>1)return null;const s=t.includes(a),o=ye(a),l=Math.floor(Math.log2(a)),r=a-Math.pow(2,l),p=Math.pow(2,l),m=Math.max(40,800/Math.pow(2,l)),d=(r-(p-1)/2)*m,u=l*k;return a===1?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute flex items-center justify-center border-2 border-dashed border-slate-300 rounded-full z-10 font-bold select-none text-slate-400 bg-white",style:{width:g,height:g,marginLeft:-g/2,marginTop:-g/2,left:d,top:u},children:e.jsx("span",{className:"text-xs",children:"Root"})}),e.jsx(D,{index:2,x:-.5*Math.max(40,800/2),y:k,parentX:d,parentY:u}),e.jsx(D,{index:3,x:.5*Math.max(40,800/2),y:k,parentX:d,parentY:u})]}):e.jsxs(e.Fragment,{children:[e.jsxs(J.div,{layout:!0,initial:{scale:0},animate:{x:d,y:u,scale:1},transition:{type:"spring",stiffness:300,damping:25},className:`absolute flex items-center justify-center border-2 rounded-full shadow-md z-20 font-bold select-none
          ${s?"border-amber-500 bg-amber-100 ring-4 ring-amber-200 text-amber-900":o==="min"?"border-blue-500 bg-blue-50 text-blue-700":"border-red-500 bg-red-50 text-red-700"}
        `,style:{width:g,height:g,marginLeft:-g/2,marginTop:-g/2},children:[c,e.jsx("div",{className:"absolute -top-4 text-[9px] text-slate-400 font-mono",children:a})]}),a>3&&e.jsx(D,{index:a,x:d,y:u})]})},D=({index:c,x:a,y:t,parentX:s,parentY:o})=>{if(s===void 0||o===void 0){const l=Math.floor(c/2),r=Math.floor(Math.log2(l)),p=l-Math.pow(2,r),m=Math.pow(2,r),d=Math.max(40,800/Math.pow(2,r));s=(p-(m-1)/2)*d,o=r*k}return e.jsx("svg",{className:"absolute top-0 left-0 w-px h-px overflow-visible pointer-events-none z-10",children:e.jsx(J.line,{initial:{pathLength:0},animate:{x1:s,y1:o+g/2,x2:a,y2:t-g/2,pathLength:1},stroke:"#cbd5e1",strokeWidth:"2"})})},Ee=()=>{const{t:c}=Me(["common","deap"],{useSuspense:!1}),[a]=h.useState(()=>new Ne),[t,s]=h.useState([null,null]),[o,l]=h.useState([]),[r,p]=h.useState(-1),[m,d]=h.useState([]),[u,w]=h.useState(-1),[f,$]=h.useState(!1),[A,Q]=h.useState(1),[C,H]=h.useState([]),[U,W]=h.useState(null),[S,I]=h.useState(!1),[V,O]=h.useState(""),E=h.useRef(null),[M,_]=h.useState(window.innerWidth>768),[j,z]=h.useState("logs"),[Y,ee]=h.useState("menu"),[te,se]=h.useState(320),[N,F]=h.useState(!1),ae=()=>F(!0),X=()=>F(!1),B=i=>{if(N){const n=i.clientX;n>=280&&n<600&&se(n)}};h.useEffect(()=>(window.addEventListener("mousemove",B),window.addEventListener("mouseup",X),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",X)}),[N]),h.useEffect(()=>{r===-1&&(l([{id:"init",action:"Initial",steps:[],finalSnapshot:[null,null]}]),p(0))},[]),h.useEffect(()=>{if(S){const i=setTimeout(()=>I(!1),3e3);return()=>clearTimeout(i)}},[S]);const P=(i,n)=>{v(),d(n),w(0);const x=n.length>0&&n[n.length-1].payload?.snapshot?n[n.length-1].payload.snapshot:a.getSnapshot(),b=o.slice(0,r+1);b.push({id:Math.random().toString(36),action:i,steps:n,finalSnapshot:x}),l(b),p(b.length-1),T(n.length)},T=(i,n=0)=>{$(!0);let x=n;const b=()=>{x<i-1?(x++,w(x),E.current=setTimeout(b,800/A)):$(!1)};b()},v=()=>{E.current&&clearTimeout(E.current),$(!1)},ie=i=>{v(),i>=0&&i<m.length&&w(i)},ne=()=>{if(r<=0||f)return;v();const i=r-1,n=o[i];a.heap=[...n.finalSnapshot],s(n.finalSnapshot),d(n.steps),w(n.steps.length>0?n.steps.length-1:-1),p(i)},le=()=>{if(r>=o.length-1||f)return;v();const i=r+1,n=o[i];d(n.steps),w(0),p(i),n.steps.length>0?T(n.steps.length):(a.heap=[...n.finalSnapshot],s(n.finalSnapshot))};h.useEffect(()=>{if(m.length>0&&u>=0){const i=m[u];i.payload?.snapshot&&s(i.payload.snapshot);const n=(i.targetIds||[]).map(x=>parseInt(x.replace("node-",""))).filter(x=>!isNaN(x));H(n),W(i.message||null)}},[u,m]);const G=()=>{const i=parseInt(V);isNaN(i)||(P(`Insert ${i}`,a.insert(i)),O(""))},re=()=>{t.length>2&&P("Extract Min",a.extractMin())},oe=()=>{t.length>2&&P("Extract Max",a.extractMax())},he=()=>{if(!S){I(!0);return}I(!1),f&&v(),a.heap=[null,null],s([null,null]),l([{id:"init",action:"Cleared",steps:[],finalSnapshot:[null,null]}]),p(0),d([]),w(-1),H([]),W(null)},ce=()=>j!=="tutorial"?null:Y==="menu"?e.jsxs("div",{className:"space-y-4 animate-in fade-in",children:[e.jsxs("div",{className:"p-4 bg-slate-800 rounded-xl border border-slate-700",children:[e.jsx("h3",{className:"text-white font-bold mb-1",children:"DEAP Course"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Learn about Double-ended Heaps."})]}),e.jsxs("div",{className:"text-center py-10 opacity-30",children:[e.jsx(q,{size:48,className:"mx-auto mb-4 text-slate-500"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-slate-500",children:"Levels Coming Soon"})]})]}):null;return e.jsxs("div",{className:`h-full w-full flex bg-slate-100 overflow-hidden relative font-sans text-slate-900 ${N?"cursor-col-resize select-none":""}`,children:[e.jsx("style",{children:N?"* { transition: none !important; cursor: col-resize !important; user-select: none !important; }":""}),e.jsxs("div",{style:{width:M?window.innerWidth>768?`${te}px`:"100%":"0px"},className:`h-full flex flex-col bg-slate-900 border-r border-slate-800 shrink-0 z-[100] shadow-2xl relative ${M?"":"overflow-hidden"} ${window.innerWidth<=768?"fixed left-0 top-0":"relative"}`,children:[window.innerWidth<=768&&M&&e.jsx("button",{onClick:()=>_(!1),className:"absolute top-4 right-4 text-white z-[110]",children:e.jsx(K,{size:24})}),e.jsxs("div",{className:"flex flex-col h-full w-full",children:[e.jsxs("div",{className:"flex p-2 gap-1 bg-slate-950/50",children:[e.jsxs("button",{onClick:()=>z("logs"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${j==="logs"?"bg-blue-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx(pe,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Logs"})]}),e.jsxs("button",{onClick:()=>z("wiki"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${j==="wiki"?"bg-amber-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx(de,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Wiki"})]}),e.jsxs("button",{onClick:()=>{z("tutorial"),ee("menu")},className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-[9px] sm:text-[10px] font-black uppercase transition-all ${j==="tutorial"?"bg-green-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:[e.jsx(q,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Course"})]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-4 font-mono text-[10px] text-slate-300 custom-scrollbar",children:[j==="logs"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-slate-500 font-black uppercase tracking-[0.2em] mb-4",children:"History"}),o.slice(1).reverse().map((i,n)=>e.jsxs("button",{onClick:()=>{v();const x=o.length-1-n;a.heap=[...i.finalSnapshot],s(i.finalSnapshot),d(i.steps),w(i.steps.length-1),p(x)},className:`w-full text-left p-3 rounded-xl border transition-all ${r===o.length-1-n?"bg-blue-600/20 border-blue-500/50 text-blue-100 shadow-inner":"bg-slate-800/30 border-slate-700/50 hover:bg-slate-800 text-slate-400"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-black uppercase tracking-wider",children:i.action}),e.jsxs("span",{className:"opacity-40 text-[8px]",children:[i.steps.length," steps"]})]}),e.jsx("div",{className:"text-[9px] opacity-60 truncate",children:i.steps[i.steps.length-1]?.message})]},i.id))]}),j==="wiki"&&e.jsxs("div",{className:"space-y-8 font-sans pb-12 text-slate-400",children:[e.jsx("h3",{className:"text-white font-black text-xs uppercase tracking-[0.3em]",children:"Knowledge Base"}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-blue-400 font-bold text-sm mb-2 uppercase",children:c("deap:wiki.concept")}),e.jsx(y,{text:c("deap:wiki.conceptDesc")})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-green-400 font-bold text-sm mb-2 uppercase",children:c("deap:wiki.structure")}),e.jsx(y,{text:c("deap:wiki.structureDesc")})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-amber-400 font-bold text-sm mb-2 uppercase",children:c("deap:wiki.insert")}),e.jsx(y,{text:c("deap:wiki.insertDesc")})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-red-400 font-bold text-sm mb-2 uppercase",children:c("deap:wiki.extract")}),e.jsx(y,{text:c("deap:wiki.extractDesc")})]})]}),j==="tutorial"&&ce()]})]}),M&&window.innerWidth>768&&e.jsx("div",{onMouseDown:ae,className:"absolute right-0 top-0 w-1.5 h-full cursor-col-resize z-[120] hover:bg-blue-500/50"})]}),e.jsxs("div",{className:"flex-grow flex flex-col min-w-0 h-full relative bg-white",children:[e.jsxs("div",{className:"flex-grow relative overflow-hidden bg-grid-slate-100",children:[e.jsx("button",{onClick:()=>_(!M),className:"absolute bottom-6 left-6 z-30 w-10 h-10 bg-slate-900 text-white rounded-2xl shadow-xl flex items-center justify-center hover:scale-110 active:scale-90 transition-all",children:M?e.jsx(K,{size:20}):e.jsx(xe,{size:20})}),e.jsx("div",{className:"absolute top-6 left-6 z-20 pointer-events-none",children:U&&e.jsxs("div",{className:"bg-blue-600/90 backdrop-blur-md px-4 py-2 rounded-2xl text-white shadow-lg border border-blue-400 flex items-center gap-2 animate-in slide-in-from-left-4",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse shrink-0"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:U})]})}),e.jsx(ue,{initialScale:1,minScale:.1,maxScale:2,centerOnInit:!0,children:({zoomIn:i,zoomOut:n,resetTransform:x})=>e.jsxs(e.Fragment,{children:[e.jsx(me,{wrapperStyle:{width:"100%",height:"100%"},children:e.jsx("div",{className:"w-[4000px] h-[4000px] relative cursor-grab active:cursor-grabbing",children:e.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{overflow:"visible"},children:[e.jsx("div",{className:"absolute",style:{left:0,top:0},children:e.jsx(Z,{value:null,index:1,highlightedIndices:[]})}),t.map((b,R)=>R>1&&e.jsx("div",{className:"absolute",style:{left:0,top:0},children:e.jsx(Z,{value:b,index:R,highlightedIndices:C})},R))]})})}),e.jsxs("div",{className:"absolute bottom-6 right-6 z-20 flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>i(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:e.jsx(fe,{size:20})}),e.jsx("button",{onClick:()=>n(),className:"w-10 h-10 bg-white shadow-sm border border-slate-200 rounded-xl flex items-center justify-center text-slate-600 hover:bg-white active:scale-90",children:e.jsx(ge,{size:20})}),e.jsx("button",{onClick:()=>x(),className:"w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center shadow-lg active:scale-90 mt-2",children:e.jsx(be,{size:20})})]})]})})]}),e.jsxs("div",{className:"bg-white border-t border-slate-200 p-3 sm:p-4 flex flex-col lg:flex-row gap-4 lg:gap-4 items-stretch overflow-visible shadow-[0_-10px_40px_rgba(0,0,0,0.03)] z-[100]",children:[e.jsxs(L,{label:"Operations",className:"w-full lg:w-[320px]",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-2 w-full",children:[e.jsxs("div",{className:"flex gap-2 items-center bg-white p-1 rounded-xl border border-slate-200 flex-grow overflow-hidden shadow-sm",children:[e.jsx("input",{value:V,onChange:i=>O(i.target.value),onKeyDown:i=>i.key==="Enter"&&G(),className:"flex-grow min-w-0 px-2 text-xs font-bold outline-none text-center",placeholder:"Val"}),e.jsx("button",{onClick:G,disabled:f,className:"px-4 py-1.5 bg-blue-600 text-white rounded-lg text-[11px] font-black shadow-md shrink-0 active:scale-95 transition-all",children:"INSERT"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:re,disabled:f,className:"px-2 py-2.5 bg-blue-500 text-white rounded-xl text-[9px] font-black shadow-lg flex flex-col items-center justify-center gap-0.5 active:scale-95 transition-all shrink-0 w-[72px]",children:[e.jsx(we,{size:12})," EXTRACT MIN"]}),e.jsxs("button",{onClick:oe,disabled:f,className:"px-2 py-2.5 bg-red-500 text-white rounded-xl text-[9px] font-black shadow-lg flex flex-col items-center justify-center gap-0.5 active:scale-95 transition-all shrink-0 w-[72px]",children:[e.jsx(je,{size:12})," EXTRACT MAX"]})]})]}),e.jsxs("button",{onClick:he,disabled:f,className:`w-full flex items-center justify-center gap-2 py-1.5 border border-dashed text-[10px] font-black rounded-lg transition-all uppercase tracking-widest ${S?"bg-red-600 border-red-600 text-white animate-bounce":"border-slate-200 text-slate-400 hover:bg-red-50 hover:text-red-500"}`,children:[e.jsx(ve,{size:12,className:S?"animate-spin":""})," ",S?"Confirm Reset?":"Reset Playground"]})]}),e.jsx(L,{label:"Timeline",className:"flex-grow",metadata:`Step ${Math.max(0,u+1)} / ${m.length}`,children:e.jsx(Se,{isPlaying:f,isPaused:!f,onTogglePause:()=>f?v():T(m.length,u),onGoToStep:ie,currentStep:u,totalSteps:m.length,onUndo:ne,onRedo:le,canUndo:r>0,canRedo:r<o.length-1,playbackSpeed:A,setPlaybackSpeed:Q})}),e.jsx(L,{label:"Array Representation",className:"w-full lg:w-[250px] shrink-0",children:e.jsxs("div",{className:"flex items-center gap-1 overflow-x-auto pb-2 custom-scrollbar no-pan h-full",children:[t.map((i,n)=>n>1&&e.jsxs("div",{className:`flex flex-col items-center shrink-0 group ${C.includes(n)?"scale-110":""} transition-all`,children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded border text-xs font-bold ${C.includes(n)?"bg-amber-100 border-amber-500 text-amber-900":"bg-slate-50 border-slate-200 text-slate-600"}`,children:i}),e.jsx("span",{className:"text-[9px] text-slate-500 font-mono font-bold",children:n})]},n)),t.length<=2&&e.jsx("span",{className:"text-xs text-slate-400 italic px-2",children:"Empty Heap"})]})})]})]})]})};export{Ee as DeapPage};
